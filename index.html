<!DOCTYPE html>
<html itemscope="" itemtype="http://schema.org/SearchResultsPage" lang="zh-CN">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta charset="utf-8">
    <meta content="always" name="referrer">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>汉服组织查询系统 - 汉服百科</title>
    <style type="text/css">
        html,
        body {
            width: 100%;
            height: 100%;
        }


        body,
        button,
        input,
        select,
        textarea {
            font: 12px/16px Verdana, Helvetica, Arial, sans-serif;
        }

        #container {
            width: 100%;
            height: 100%;
        }

        #mapContainer {
            position: relative;
            height: 100%;
            width: 100%;
        }

        .clusterBubble {
            border-radius: 50%;
            color: #fff;
            font-weight: 500;
            text-align: center;
            opacity: 0.88;
            background-image: linear-gradient(139deg, #e82f40 0%, #fb0e4f 100%);
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.20);
            position: absolute;
            top: 0px;
            left: 0px;
        }

        /* 组织信息页面 */
        @font-face {
            font-family: "iconfont";
            src: url('//at.alicdn.com/t/font_1692848_ofchcawy11.eot?t=1597031491457');
            /* IE9 */
            src: url('//at.alicdn.com/t/font_1692848_ofchcawy11.eot?t=1597031491457#iefix') format('embedded-opentype'),
                /* IE6-IE8 */
                url('data:application/x-font-woff2;charset=utf-8;base64,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') format('woff2'),
                url('//at.alicdn.com/t/font_1692848_ofchcawy11.woff?t=1597031491457') format('woff'),
                url('//at.alicdn.com/t/font_1692848_ofchcawy11.ttf?t=1597031491457') format('truetype'),
                /* chrome, firefox, opera, Safari, Android, iOS 4.2+ */
                url('//at.alicdn.com/t/font_1692848_ofchcawy11.svg?t=1597031491457#iconfont') format('svg');
            /* iOS 4.1- */
        }

        .iconfont {
            font-family: "iconfont" !important;
            font-size: 16px;
            font-style: normal;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .iconlianxiren:before {
            content: "\e654";
        }

        .icondianhua:before {
            content: "\e614";
        }

        .iconshouji:before {
            content: "\e70a";
        }

        .iconleixing:before {
            content: "\e605";
        }

        .iconqq:before {
            content: "\e601";
        }

        .iconfanhui:before {
            content: "\e602";
        }

        .icondizhi:before {
            content: "\e603";
        }

        .iconweixin:before {
            content: "\e604";
        }


        .orgpage {
            background: #f6f6f6;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            word-break: break-all;
            width: auto;
            text-align: left;
            white-space: initial;
            line-height: 1.2;
        }

        swiper {
            height: 215px;
            width: 100vw;
            background: #eee;
        }

        swiper .slide {
            width: 100%;
            height: 100%;
        }

        .head-wrapper {
            position: relative;
            background: #fff;
        }

        .head-wrapper.logo-mode .title {
            padding: 5px 10px 10px 90px;
        }

        .head-wrapper .logo {
            position: absolute;
            top: -30px;
            left: 5px;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            overflow: hidden;
            background: #eee;
            border: 4px solid #fff;
        }

        .head-wrapper .title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 10px 10px 20px;
            border-bottom: 1px solid #eee;
        }

        .head-wrapper .title .name {
            font-size: 21px;
        }

        .head-wrapper .navigate {
            width: 50px;
            height: 50px;
            padding: 10px;
            box-sizing: border-box;
        }

        .more {
            background: #fff;
            padding: 10px;
            margin-bottom: 5px;
            box-shadow: 0 0 10px #eee;
            font-size: 12px;
        }

        .more i {
            padding-right: 2px;
            color: #37aafc;
        }

        .item {
            font-size: 14px;
            padding-bottom: 2px;
        }

        .desc {
            min-height: 172.5px;
            background: #fff;
            padding: 10px;
            box-shadow: 0 0 10px #eee;
            margin-bottom: 10px;
            white-space: initial;
        }

        .desc .title {
            font-size: 18px;
            margin-bottom: 10px;
        }

        .desc .title::before {
            content: "|";
            padding-right: 4px;
            color: #37aafc;
        }

        .desc .content {
            font-size: 14px;
        }

        .video-wrapper {
            margin: 15px 0;
        }

        .video-wrapper video {
            width: 100%;
        }

        .video-wrapper .copyright {
            font-size: 10px;
            padding-top: 5px;
            color: #aaa;
        }

        .video-wrapper .copyright .name {
            color: #37aafc;
        }

        .adContainer {
            width: 90%;
            margin: 0 auto;
            margin-bottom: 10px;
        }

        .layout {
            width: 1000px;
            margin: 30px auto;
        }

        ul,
        ol,
        li {
            list-style: none;
        }

        .slide {
            position: relative;
            width: 100%;
            height: 260px;
            margin: auto;
        }

        .slide .outer {
            position: relative;
            overflow: hidden;
            height: 260px;
        }

        .slide .outer .inner {
            width: 2800px;
            height: 100%;
            position: absolute;
            left: 0px;
            top: 0;
            padding-left: 0px;
            margin-block-start: 0px;
        }

        .slide .outer .inner li {
            float: left;
            height: 100%;
        }

        .slide .outer .inner li a {
            display: block;
            position: relative;
            width: 400px;
            height: 100%;
        }

        .slide .outer .inner li a p {
            position: absolute;
            left: 0;
            bottom: 0;
            color: #fff;
            font-size: 18px;
            width: auto;
            height: 80px;
            line-height: 80px;
            padding-left: 50px;
            background: linear-gradient(180deg, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.5));
        }
        .slide .outer .inner li a img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .slide .outer .dot {
            margin-top: 52%;
            text-align: center;
            position: relative;
        }

        .slide .outer .dot li {
            height: 6px;
            width: 6px;
            border-radius: 3px;
            background-color: #d2cbcb;
            display: inline-block;
            margin: 0 3px;
        }

        .slide .outer .dot li.active {
            background-color: #6e5ca5;
        }

        .slide .arrow-box {
            position: absolute;
            width: 100%;
            height: 60px;
            top: 40%;
            left: 0;
        }

        .slide .arrow-box .arrow {
            width: 30px;
            height: 30px;
            line-height: 30px;
            text-align: center;
            border-radius: 30px;
            background-color: #dde2e6;
            font-size: 30px;
            color: #999;
            cursor: pointer;
        }

        .slide .arrow-box .arrow.arrow-l {
            float: left;
        }

        .slide .arrow-box .arrow.arrow-r {
            float: right;
        }

        #searchPart {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 1001;
            width: 19rem;
            box-shadow: 0 2px 2px rgba(0,0,0,.15);
        }

        .weui-search-bar__box {
            padding-left: 54px !important;
        }
        .weui-search-bar__box .weui-icon-search {
            left: 32px !important;
        }
        .weui-search-bar__form .logo {
            display: block;
            position: fixed;
            width: 34px;
            height: 34px;
            z-index: 99999;
            cursor: pointer;

        }
        .weui-search-bar__box .weui-search-bar__input{
            font-size: 15px !important;
        }
        .weui-search-bar__label span{
            font-size: 15px !important;
        }
        .weui-search-bar__cancel-btn{
            font-size: 15px !important;
        }
        .tips{
            font-size: 15px !important;
        }

        .common_content_box {
            position: absolute;
            right: 0;
            left: 0;
            z-index: 1;
            width: 100%;
        }
        .back {
            position: absolute;
            top: 8px;
            left: 15px;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(0,0,0,.4)url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAArCAQAAADIkIBwAAABG0lEQVR4Ac3V1UEDURSE4cHd3d2tJ4qAArYTSsBdX5Js3FMCDSBBhoM791x85e37V54G5oM19PIA2oO1DJD0Iw+5yNHylL8TJShGgSQGHhSe3OlGNerkLkaejtegBa2SlHwQsO6RC+6QpBpFyDXwra4b3il37c3zc97jIeGJH+L1D7zWgm90annYml+qecNv8LUOLY/Y8ajwuJJL4FpxCfzkRcjpU3LgsOkyTp7GpqfQpuBy5C10ZlPkSXxmCOXIN3EJUOqMnGTIbHSuUxPkogg1sxOnafIsstBm/qQcISWo/XwS/fEkRUmW2/9nEvudZK3jF5L4byTZEEoskpPIsQ+1FoliUF4lTydLlTwdRVVSpJrdJ0muRDe/fAU7fxi1KmBZtgAAAABJRU5ErkJggg==) no-repeat center 7px;
            background-size: 12px 21.5px;
            z-index: 9999;
        }
        .map_zoom {
            right: 15px;
            width: 36px;
            height: 84px;
            position: absolute;
            border-radius: 4px;
            background-color: #fff
        }

        .map_zoomin, .map_zoomout {
            display: block;
            height: 41px;
            background: #fff url(data:image/png;base64,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) no-repeat;
            background-size: 48px 329px;
            cursor: pointer;
            margin: 0 7px;
        }
        .map_zoomout {
            background-position: -30px 13px;
        }
        .map_zoomin {
            border-bottom: 1px solid #ddd;
            background-position: -1px 13px;
        }
        .map{
            width: 100%;
            height: 100%;
        }
    </style>
    <script src="//libs.baidu.com/jquery/2.1.1/jquery.min.js"></script>
    <script src="//cdn.staticfile.org/history.js/1.8/bundled-uncompressed/html5/jquery.history.js"></script>
    <!--引入Javascript API GL，参数说明参见下文-->
    <script src="//map.qq.com/api/gljs?v=1.exp&key=AIZBZ-F5M62-ACTUF-C2LQH-DQKC7-TVB7A"></script>
    <link rel="stylesheet" href="//res.wx.qq.com/open/libs/weui/2.0.1/weui.min.css">
    <script type="text/javascript" src="//res.wx.qq.com/open/libs/weuijs/1.2.1/weui.min.js"></script>
    <script>
        function getUrlParam(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
            var r = decodeURI(window.location.search.substr(1)).match(reg);
            if (r != null) return unescape(r[2]); return null;
        }


        var thisOrgName = decodeURI(getUrlParam("orgname"))
        var pagetitle = document.title
        var center = ''
        var map = {}
        var infoWindow = {}
        var orgList = []
        var orginZoom = 4.5;
        (function(window,undefined){

            // Bind to StateChange Event
            History.Adapter.bind(window,'statechange',function(){ // Note: We are using statechange instead of popstate
                var State = History.getState(); // Note: We are using History.getState() instead of event.state
                console.log(State)
                if(State.url == `${window.location.origin}/`){
                    $('#common_content_box').html()
                    $("#searchPart").show()
                    $("#container").show()
                    if(infoWindow.close){
                        infoWindow.close()
                    }
                    
                }
            });
            History.replaceState(null,`${pagetitle}`,'/')
        })(window);
        function back(){
            console.log('back')
            History.replaceState(null,`${pagetitle}`,'/')
        }
        var orgPageHtml = `<div class="orgpage" id="orgpage">
            <!-- SWIPER -->
            <div class="slide" id="slide">
                <div class="back" onclick="back()"></div>
                <div id="outer" class="outer">
                    <ul id="inner" class="inner">
                    </ul>

        　　　　　　　<!--底部小圆点-->
                    <ol class="dot" id="dot">
                        <li class="active"></li>
                    </ol>
                </div>
    　　　　    <!--左右两侧的点击切换按钮-->
                <div class="arrow-box">
                    <div class="arrow arrow-l" id="arrow_l">‹</div>
                    <div class="arrow arrow-r" id="arrow_r">›</div>
                </div>
            </div>

            <!-- HEADER -->
            <div class="head-wrapper logo-mode">
                <img class="logo" id="logoImage" src=""></img>
                <div class="title">
                <div class="name" id="orgName"></div>
                <div style="display: flex;">
                    <img class="navigate" id="navigate" src="/res/navigate.png" bindtap="navigateTo"></img>
                </div>
                </div>
            </div>

            <!-- MORE -->
            <div class="more">
                <div class="item" id="orgType" bindtap="navigateTo">
                <i class="iconfont iconleixing"></i>
                <pp>
                    组织类型：
                </pp>
                </div>
                <div class="item" id="locationAddress" bindtap="navigateTo">
                <i class="iconfont icondizhi"></i>
                <pp>
                组织地址：
                </pp>
                </div>
                <div class="item" id="telNumble" style="display: none;">
                <i class="iconfont icondianhua"></i>
                <pp>
                    联系电话：
                </pp>
                </div>
                <div class="item" id="QQGroup" bindtap="navigateTo">
                <i class="iconfont iconqq"></i>
                <pp>
                QQ 群号：
                </pp>
                </div>

                <div class="item" id="wxmp" bindtap="navigateTo">
                <i class="iconfont iconweixin"></i>
                <pp>
                    微信公众号：
                </pp>
                </div>
            </div>

            <!-- DESC -->
            <div class="desc" style="margin-bottom: 0px;">
                <div class="title">简介</div>
                <!-- TODO: rich-text -->
                <div class="content" id="orgDesc">
                </div>

            </div>


            </div>`

        function isMobile() {
            var userAgentInfo = navigator.userAgent;
 
            var mobileAgents = [ "Android", "iPhone", "SymbianOS", "Windows Phone", "iPad","iPod"];
 
            var mobile_flag = false;
 
            //根据userAgent判断是否是手机
            for (var v = 0; v < mobileAgents.length; v++) {
                if (userAgentInfo.indexOf(mobileAgents[v]) > 0) {
                    mobile_flag = true;
                    break;
                }
            }
             var screen_width = window.screen.width;
             var screen_height = window.screen.height;   
 
             //根据屏幕分辨率判断是否是手机
             if(screen_width < 500 && screen_height < 800){
                 mobile_flag = true;
             }
 
             return mobile_flag;
        }

        var mobile_flag = isMobile();

        var MarkerStyle = {
            //创建一个styleId为"myStyle"的样式（styles的子属性名即为styleId）
            "myStyle": new TMap.MarkerStyle({
                "width": 20,  // 点标记样式宽度（像素）
                "height": 30, // 点标记样式高度（像素）
                "src": 'res/marker.png',  //图片路径
                //焦点在图片中的像素位置，一般大头针类似形式的图片以针尖位置做为焦点，圆形点以圆心位置为焦点
                "anchor": { x: 16, y: 32 }
            })
        }

        function setSwiper(){
            var interval = 3000;                //轮播间隔时间
            var arrowL = $('#arrow_l');         //左侧箭头
            var arrowR = $('#arrow_r');         //右侧箭头

            var slideBox = $('#slide');         //轮播图区域
            var innerBox = $('#inner');         //内层大盒子
            var img = innerBox.children('li');  //每个图片
            var dot = $('#dot');                //小圆点盒子
            var imgW = slideBox.outerWidth()
            //var imgW = $(img[0]).outerWidth();  //每个li标签的宽度
            var imgCount = img.length;                   //总图片个数（不同图片的个数）（实际dom上是有7张）
            for(let i = 1; i < imgCount; i++){
                dot.append("<li></li>")
            }
            $('#inner li a').css("width",imgW)
            $('#inner').css("width",imgW*imgCount)
            var i = 0;                          //初始化为第0张图片
            timer = null;                       //定时器
            if(imgCount < 2){
                return
            }
            //自动轮播
            timer = setInterval(function () {
                i++;
                innerBox.stop(false, true).animate({'left':-i*imgW+'px'},300)
                dot.find('li').removeClass('active').eq(i-1).addClass('active')
                
                if(i >= imgCount){
                    innerBox.animate({'left':0*imgW+'px'},0);
                    dot.find('li').removeClass('active').eq(0).addClass('active')
                    i = 0;
                }
            },interval)

            //点击右侧箭头，播放下一张
            arrowR.click(function () {
                i++;
                innerBox.stop(false, true).animate({'left':-i*imgW+'px'},300)
                dot.find('li').removeClass('active').eq(i-1).addClass('active')
                
                if(i >= imgCount){
                    innerBox.animate({'left':0*imgW+'px'},0);
                    dot.find('li').removeClass('active').eq(0).addClass('active')
                    i = 0;
                }
            })

            //点击左侧箭头，播放上一张
            arrowL.click(function () {
                i--;
                innerBox.stop(false, true).animate({'left':-i*imgW+'px'},300)
                dot.find('li').removeClass('active').eq(i-1).addClass('active')
                
                if(i < 1){
                    innerBox.animate({'left':(-imgCount+1)*imgW+'px'},0);
                    dot.find('li').removeClass('active').eq(imgCount-1).addClass('active')
                    i = imgCount;
                }
            })

            //鼠标经过轮播图区域时，清除定时器，停止自动轮播
            slideBox.mouseenter(function () {
                clearInterval(timer);
            })

            //鼠标离开轮播图区域时，重新启动自动轮播
            slideBox.mouseleave(function () {
                timer = setInterval(function () {
                    i++;
                    innerBox.stop(false, true).animate({'left':-i*imgW+'px'},300)
                    dot.find('li').removeClass('active').eq(i-1).addClass('active')
                    
                    if(i >= imgCount){
                        innerBox.animate({'left':0*imgW+'px'},0);
                        dot.find('li').removeClass('active').eq(0).addClass('active')
                        i = 0;
                    }
                },interval)
            })
        }

        function DraggableOn(){
            map.setDraggable(true)
        }

        function DraggableOff(){
            map.setDraggable(false)
        }

        function setInfoWindow(orgname,orgid,latLng,isSearch=false,isClick=false) {
            if(isClick && getUrlParam('orgname')){
                console.log("替换链接")
                History.replaceState(null,`${orgname} - 汉服百科`,`?orgname=${orgname}`)
            }else if(!getUrlParam('orgname')){
                console.log("添加链接")
                History.pushState(null,`${orgname} - 汉服百科`,`?orgname=${orgname}`)  
            }
            
            //
            let mapPoint = {}
            let pageHeight = $(window).height()
            let orgpage = $('#orgpage')

            if(mobile_flag){
                $('#common_content_box').html(orgPageHtml)
                $("#searchPart").hide()
                $("#map").hide()
                $(".arrow-box").hide()
            }else{
                //设置infoWindow
                infoWindow.open(); //打开信息窗
                infoWindow.setPosition(latLng);//设置信息窗位置
                let orgNameLink = `<div style="width:400px">${orgPageHtml}</div>`
                infoWindow.setContent(orgNameLink);//设置信息窗内容
                if(isSearch){
                    orginZoom = map.getZoom()
                    map.setZoom(14)
                    infoWindow.on("closeclick",function(){
                        map.zoomTo(orginZoom)
                        History.replaceState(null,pagetitle,"/")
                    })
                }else{
                    infoWindow.on("closeclick",function(){
                        History.replaceState(null,pagetitle,"/")
                    })
                }
                
                orgpage.mouseenter(function(){
                    map.setDraggable(false)
                })
                orgpage.mouseleave(function(){
                    map.setDraggable(true)
                })
                
                map.panTo(latLng)
                mapPoint = map.projectToContainer(latLng)
                map.panTo(map.unprojectFromContainer({x:mapPoint.x,y:mapPoint.y-pageHeight/2+80}),2000)
            }


            
            //map.setDraggable(false)


            $('#orgName').text(`${orgname}`)
            let getUrl = "//master-xzb1z.service.tcloudbase.com/orginfo"
            $.get(getUrl, { "id": orgid }, function (res) {
                console.log(res)
                let orgInfo = res.orgInfo
                $('#orgName').text(`${orgInfo.orgName}`)
                $('#logoImage').attr("src", `${orgInfo.logoList[0]}`)
                let imgBanner = ""
                for (let x in orgInfo.orgImageList) {
                    let imgUrl = orgInfo.orgImageList[x]
                    imgBanner +=`<li><a href="${imgUrl}" target="_blank"><img src="${imgUrl}"></a></li>`
                }
                $('#inner').html(`${imgBanner}`)
                setSwiper()
                $('#orgType pp').text(`组织类型：${orgInfo.orgType}`)
                $('#locationAddress pp').text(`组织地址：${orgInfo.locationAddress}`)
                if(orgInfo.telNumble){
                    $('#telNumble pp').text(`联系电话：${orgInfo.telNumble}`)
                    $('#telNumble').show()
                }else{
                    $('#telNumble').hide()
                }
                
                $('#QQGroup pp').text(`QQ群号：${orgInfo.QQGroup}`)
                $('#wxmp pp').text(`微信公众号：${orgInfo.wxmp}`)
                $('#orgDesc').text(`${orgInfo.orgDesc}`)

            })
        }

        function markerClick(evt){
            let geometry = evt.geometry
            let orgname = geometry.properties.title.toString()
            let orgid =  geometry.properties.orgid
            let latLng = geometry.position
            setInfoWindow(orgname,orgid,latLng,false,true)
        }        

        function setMarkers(data) {
            orgList = data.orgList
            console.log(orgList)
            //创建并初始化MultiMarker
            var markerLayer = new TMap.MultiMarker({
                map: map,  //指定地图容器
                //样式定义
                styles: MarkerStyle,
                //点标记数据数组
                geometries: [
                ]
            });
            var markerList = []
            var positionList = []
            
            var thisOrgjson = {}
            for (let x in orgList) {
                let lat = orgList[x].longLatiute.coordinates[1]
                let lng = orgList[x].longLatiute.coordinates[0]
                let name = orgList[x].orgName
                let id = orgList[x]._id
                if (name == thisOrgName){
                    thisOrgjson.orgName = name
                    thisOrgjson.position = new TMap.LatLng(lat, lng)
                    thisOrgjson.orgid = id
                }
                positionList.push({
                    position: new TMap.LatLng(lat, lng)
                })
                let marker = {
                    "id": x,   //点标记唯一标识，后续如果有删除、修改位置等操作，都需要此id
                    "styleId": 'myStyle',  //指定样式id
                    "position": new TMap.LatLng(lat, lng),  //点标记坐标位置
                    "properties": {//自定义属性
                        "title": name,
                        "orgid": id
                    }
                }
                markerList.push(marker)

            }

            markerLayer.on("click", markerClick)
            //markerLayer.add(markerList)


            //创建点聚合对象
            var markerCluster = new TMap.MarkerCluster({
                id: 'cluster', //图层id
                map: map,       //设置点聚合显示在哪个map对象中（创建map的段落省略）
                enableDefaultStyle: false,   //使用默认样式
                minimumClusterSize: 2,  //最小聚合点数：2个
                geometries: markerList, //....将您所有要打到图中的坐标点传入进来
                zoomOnClick: true,  //点击聚合数字放大展开
                gridSize: 60,       //聚合算法的可聚合距离，即距离小于该值的点会聚合至一起，默认为60，以像素为单位
                averageCenter: false, //每个聚和簇的中心是否应该是聚类中所有标记的平均值
                maxZoom: 16 //采用聚合策略的最大缩放级别，若地图缩放级别大于该值，则不进行聚合，标点将全部被展开
            });
            /*
            var label = new TMap.MultiLabel({
                    id: 'label-layer',
                    map: map,
                    enableCollision:true,
                    styles: {
                        'label': new TMap.LabelStyle({
                            'color': '#3777FF', //颜色属性
                            'size': 12, //文字大小属性
                            'offset': { x: 0, y: 0 }, //文字偏移属性单位为像素
                            'angle': 0, //文字旋转属性
                            'alignment': 'center', //文字水平对齐属性
                            'verticalAlignment': 'middle' //文字垂直对齐属性
                        })
                    },
                    geometries: [{
                        'id': 'label', //点图形数据的标志信息
                        'styleId': 'label', //样式id
                        'position': new TMap.LatLng(39.954104, 116.357503),  //点标记坐标位置
                        'content': '腾讯北京总部', //标注文本
                        'properties': { //标注点的属性数据
                            'title': 'label'
                        }
                    }]
                })
                */
            //初始化infoWindow
            infoWindow = new TMap.InfoWindow({
                map: map,
                position: new TMap.LatLng(39.984104, 116.307503),
                zIndex:2,
                offset: { x: 0, y: -48 } //设置信息窗相对position偏移像素，为了使其显示在Marker的上方
            });
            infoWindow.close();//初始关闭信息窗关闭
            infoWindow.on("closeclick",function(){
                History.replaceState(null,pagetitle,"/")
            })
            if(thisOrgjson.orgName){
                setInfoWindow(thisOrgjson.orgName,thisOrgjson.orgid,thisOrgjson.position,true)
            }
            var clusterBubbleList = [];
            var markerGeometries = [];
            var marker = null;

            // 监听聚合簇变化
            markerCluster.on('cluster_changed', function (e) {
                // 销毁旧聚合簇生成的覆盖物
                if (clusterBubbleList.length) {
                    clusterBubbleList.forEach(function (item) {
                        item.destroy();
                    })
                    clusterBubbleList = [];
                }
                markerGeometries = [];

                // 根据新的聚合簇数组生成新的覆盖物和点标记图层
                var clusters = markerCluster.getClusters();
                clusters.forEach(function (item) {
                    if (item.geometries.length > 1) {
                        let clusterBubble = new ClusterBubble({
                            map,
                            position: item.center,
                            content: item.geometries.length,
                        });
                        clusterBubble.on('click', () => {
                            map.fitBounds(item.bounds);
                        });
                        clusterBubbleList.push(clusterBubble);
                    } else {
                        markerGeometries.push(item.geometries[0]);
                    }
                });

                if (markerLayer) {
                    // 已创建过点标记图层，直接更新数据
                    markerLayer.setGeometries(markerGeometries);
                } else {
                    // 创建点标记图层
                    markerLayer = new TMap.MultiMarker({
                        map,
                        styles: MarkerStyle,
                        geometries: markerGeometries
                    });
                    markerLayer.on("click", setInfoWindow)
                }
            });


            //监听标注点击事件
            markerCluster.on("click", function (evt) {
                console.log(evt)
                let geometries = evt.cluster.geometries
                //设置infoWindow
                infoWindow.open(); //打开信息窗
                infoWindow.setPosition(geometries[0].position);//设置信息窗位置
                infoWindow.setContent(geometries[0].properties.title.toString());//设置信息窗内容
                for (let x in geometries) {

                }


            })

        }

        //地图初始化函数，本例取名为init，开发者可根据实际情况定义
        function initMap() {
            //定义地图中心点坐标
            var center = new TMap.LatLng(35.71567199798269, 107.76217916748408)
            //center = new TMap.LatLng(37.846664,112.553555);
            //定义map变量，调用 TMap.Map() 构造函数创建地图
            map = new TMap.Map(document.getElementById('container'), {
                center: center,//设置地图中心点坐标
                zoom: orginZoom,   //设置地图缩放级别
                pitch: 0,  //设置俯仰角
                rotation: 0,    //设置地图旋转角度
                mapStyleId: "style3",
                showControl:false
            });
            //map.on("mousedown",function(res){
                //console.log(res)
                //map.setDraggable(true)
            //})
           // map.on("touchstart",function(res){
                //console.log(res)
                //map.setDraggable(true)
            //})
            map.on("click",function(res){
                infoWindow.close()
                History.replaceState(null,pagetitle,"/")
            })
            let postUrl = "//master-xzb1z.service.tcloudbase.com/orgList"
            $.get(postUrl, "", setMarkers)


            // 以下代码为基于DOMOverlay实现聚合点气泡
            function ClusterBubble(options) {
                TMap.DOMOverlay.call(this, options);
            }

            ClusterBubble.prototype = new TMap.DOMOverlay();

            ClusterBubble.prototype.onInit = function (options) {
                this.content = options.content;
                this.position = options.position;
            };

            // 销毁时需要删除监听器
            ClusterBubble.prototype.onDestroy = function () {
                this.dom.removeEventListener('click', this.onClick);
                this.removeAllListeners();
            };

            ClusterBubble.prototype.onClick = function () {
                this.emit('click');
            };

            // 创建气泡DOM元素
            ClusterBubble.prototype.createDOM = function () {
                var dom = document.createElement('div');
                dom.classList.add('clusterBubble');
                dom.innerText = this.content;
                dom.style.cssText = [
                    'width: ' + (40 + parseInt(this.content) * 2) + 'px;',
                    'height: ' + (40 + parseInt(this.content) * 2) + 'px;',
                    'line-height: ' + (40 + parseInt(this.content) * 2) + 'px;',
                ].join(' ');

                // 监听点击事件，实现zoomOnClick
                this.onClick = this.onClick.bind(this);
                dom.addEventListener('click', this.onClick);
                return dom;
            };

            ClusterBubble.prototype.updateDOM = function () {
                if (!this.map) {
                    return;
                }
                // 经纬度坐标转容器像素坐标
                let pixel = this.map.projectToContainer(this.position);

                // 使文本框中心点对齐经纬度坐标点
                let left = pixel.getX() - this.dom.clientWidth / 2 + 'px';
                let top = pixel.getY() - this.dom.clientHeight / 2 + 'px';
                this.dom.style.transform = `translate(${left}, ${top})`;

                this.emit('dom_updated');
            };

            window.ClusterBubble = ClusterBubble;

        }

    </script>
</head>
<!-- 页面载入后，调用init函数 -->

<body onload="initMap()">
    <!-- 定义地图显示容器 -->
    <div class="map" id="map">
        <div class="page__bd" id="searchPart">
            <!--<a href="javascript:" class="weui-btn weui-btn_primary">点击展现searchBar</a>-->
            <div class="weui-search-bar" id="searchBar" style="background-color: #fff;">
                <form class="weui-search-bar__form">
                    <img class="logo" src="/res/logo.png">
                    <div class="weui-search-bar__box">
                        <i class="weui-icon-search"></i>
                        <input type="search" class="weui-search-bar__input" id="searchInput" placeholder="请输入组织名或城市名" required/>
                        <a href="javascript:" class="weui-icon-clear" id="searchClear"></a>
                    </div>
                    <label class="weui-search-bar__label" id="searchText">
                        <i class="weui-icon-search"></i>
                        <span>搜索</span>
                    </label>
                </form>
                <a href="javascript:" class="weui-search-bar__cancel-btn" id="searchCancel">取消</a>
            </div>
            <div class="weui-cells searchbar-result" id="searchResult" style="display: none;">

            </div>
        </div>

        <div id="container">

        </div>
        <div class="map_zoom map_icon_shadow" style="bottom: 135px;">
            <a href="javascript:void(0);" class="map_zoomin" id="zoomin"></a>
            <a href="javascript:void(0);" class="map_zoomout" id="zoomout"></a>
        </div>
    </div>
    <div class="common_content_box" id="common_content_box"></div>
    <script type="text/javascript">

        function clickTips(self){
            let searchResult = $('#searchResult')
            searchResult.hide();
            let isSearch = true
            let orgName = $(self).data('orgname')
            let orgid = $(self).data('orgid')
            let lat = $(self).data('lat')
            let lng = $(self).data('lng')
            let latLng = new TMap.LatLng(lat, lng)
            setInfoWindow(orgName,orgid,latLng,isSearch)
            //map.zoomTo(8)
        }
        $('#zoomin').click(function(){
                map.zoomTo(map.getZoom()+1)
            })
        $('#zoomout').click(function(){
            map.zoomTo(map.getZoom()-1)
        })
        $(function(){
            var $searchBar = $('#searchBar'),
                $searchResult = $('#searchResult'),
                $searchText = $('#searchText'),
                $searchInput = $('#searchInput'),
                $searchClear = $('#searchClear'),
                $searchCancel = $('#searchCancel');
    
            function hideSearchResult(){
                $searchResult.hide();
                $searchInput.val('');
            }
            function cancelSearch(){
                hideSearchResult();
                $searchBar.removeClass('weui-search-bar_focusing');
                $searchText.show();
            }

            function clearInput(){
                $searchResult.hide();
                History.replaceState(null,pagetitle,"/")
                infoWindow.close()
                map.zoomTo(orginZoom)
            }
    
            $searchText.on('click', function(){
                $searchBar.addClass('weui-search-bar_focusing');
                $searchInput.focus();
            });
            $searchInput
                .on('blur', function () {
                    if(!this.value.length){
                        clearInput();
                        cancelSearch();
                    } 
                })
                .on('input', function(){
                    if(this.value.length) {
                        let searchTips = []
                        let value = this.value
                        let tempHtml = ""
                        let i = 0
                        for(let x in orgList){
                            if(i >10){
                                break
                            }
                            let orgName = orgList[x].orgName
                            let orgid = orgList[x]._id
                            let locationAddress = orgList[x].locationAddress
                            let lat = orgList[x].longLatiute.coordinates[1]
                            let lng = orgList[x].longLatiute.coordinates[0]
                            let nameIndex = orgName.indexOf(value)
                            let addressIndex = locationAddress.indexOf(value)
                            let orgTips1 = ""
                            let orgTips2 = ""
                            let addressTips1 = ""
                            let addressTips2 = ""
                            if(nameIndex > -1 || addressIndex > -1){
                                if(nameIndex > -1){
                                    orgTips1 = orgName.split(value)[0]
                                    orgTips2 = orgName.split(value)[1]
                                }else if(addressIndex > -1){
                                    addressTips1 = locationAddress.split(value)[0]
                                    addressTips2 = locationAddress.split(value)[1]
                                }
                                
                                i++
                                tempHtml += `<div class="weui-cell weui-cell_active weui-cell_access" onclick="clickTips(this)" data-orgid="${orgid}" data-orgname="${orgName}" data-lat="${lat}" data-lng="${lng}">
                                                    <div class="weui-cell__bd weui-cell_primary tips">
                                                        <p>${orgName}</p>
                                                        <p style="font-size:12px;left:4px;color: #999;">${locationAddress}</p>
                                                    </div>
                                                </div>`
                                
                            }
                        }
                        $searchResult.html(tempHtml)
                        if(tempHtml){
                            $searchResult.show();
                        }
                        
                    } else {
                        //$searchResult.children(".weui-cell_access").remove()
                        clearInput()
                    }
                })
            ;
            $searchClear.on('click', function(){
                hideSearchResult();
                $searchInput.focus();
            });
            $searchCancel.on('click', function(){
                cancelSearch();
                $searchInput.blur();
            });
            if(mobile_flag){
                $("#searchPart").css("width","auto")
                $("#searchPart").css("right","10px")
            }
        });
    </script>
</body>

</html>